<?xml version="1.0" encoding="UTF-8"?>

<project name="test-gather" default="failure1">

	<!-- note that the test is hard-coded to create the "test.loader" reference -->
    <typedef
    	loaderRef="test.loader"
    	resource="com/tibco/devtools/workspace/installer/tasks/wi.antlib.xml" />

	<!-- a bunch of failure cases - to verify that error checking works correctly for gathering
		Note that to avoid having these tests be sensitive to the order in which the ant task
		verifies the various attributes, each test has all attributes properly configured,
		except for one. -->
	
	<!-- first - check that localsitecache attribute is specified -->
	<target name="failure1">
		<evaluate.dependencies refidname="results.1">
			<updatesites>
				<updatesite url="http://spin.tibco.com/milestones/thirdparty/site.xml" />
			</updatesites>
			<featuresearchpath>
				<pathelement path="${basedir}/features" />
			</featuresearchpath>
		</evaluate.dependencies>
	</target>

	<!-- now check for missing update sites -->
	<target name="failure2">
		<evaluate.dependencies
			refidname="results.2"
			localsitecache="cacheDir">
			<featuresearchpath>
				<pathelement path="${basedir}/features" />
			</featuresearchpath>
		</evaluate.dependencies>
	</target>

	<!-- check for missing feature search path -->
	<target name="failure3">
		<evaluate.dependencies
			refidname="results.3"
			localsitecache="cacheDir">
			<updatesites>
				<updatesite url="http://spin.tibco.com/milestones/thirdparty/site.xml" />
			</updatesites>
		</evaluate.dependencies>
	</target>
	
	<target name="failure4">
		<evaluate.dependencies
			refidname="results.4"
			localsitecache="cacheDir">
			<updatesites>
				<updatesite url="http://spin.tibco.com/milestones/thirdparty/site.xml" />
			</updatesites>
			<featuresearchpath>
				<pathelement path="${basedir}/features" />
				<pathelement path="${basedir}/bogus" />
				<pathelement path="${foodir}" />
				<pathelement path=" " />
			</featuresearchpath>
		</evaluate.dependencies>
	</target>
	
	<target name="failure5">
		<evaluate.dependencies
			localsitecache="cacheDir">
			<updatesites>
				<updatesite url="http://spin.tibco.com/milestones/thirdparty/site.xml" />
			</updatesites>
			<featuresearchpath>
				<pathelement path="${basedir}/features" />
			</featuresearchpath>
		</evaluate.dependencies>
	</target>
	
	<targets id="my.feature.set">
		<target feature="com.foo" version="1.2.3.004" />
	</targets>
	
</project>
